<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Go-Zero on Skylm</title>
        <link>https://skylm808.github.io/tags/go-zero/</link>
        <description>Recent content in Go-Zero on Skylm</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>Skylm</copyright>
        <lastBuildDate>Fri, 16 Jan 2026 08:00:00 +0800</lastBuildDate><atom:link href="https://skylm808.github.io/tags/go-zero/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>go-zero 的 Model 层 Redis 缓存机制</title>
        <link>https://skylm808.github.io/p/go-zero-%E7%9A%84-model-%E5%B1%82-redis-%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/</link>
        <pubDate>Fri, 16 Jan 2026 08:00:00 +0800</pubDate>
        
        <guid>https://skylm808.github.io/p/go-zero-%E7%9A%84-model-%E5%B1%82-redis-%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/</guid>
        <description>&lt;p&gt;在构建高性能微服务时，数据库往往是性能瓶颈。go-zero 在 Model 层内置了一套高效且自动化的 Redis 缓存机制。本文基于源码逻辑，讲清楚它如何处理主键缓存、唯一索引缓存以及数据一致性。&lt;/p&gt;
&lt;h2 id=&#34;1-核心设计哲学index-cache索引缓存&#34;&gt;1. 核心设计哲学：Index Cache（索引缓存）
&lt;/h2&gt;&lt;p&gt;go-zero 并没有采用“大杂烩”式的缓存策略，而是严格遵循 &lt;strong&gt;“所有查询最终都回归到 ID”&lt;/strong&gt; 的设计原则。&lt;/p&gt;
&lt;h3 id=&#34;11-两种缓存类型&#34;&gt;1.1 两种缓存类型
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Primary Cache (主键缓存)&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Key&lt;/strong&gt;: &lt;code&gt;cache:user:id:1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Value&lt;/strong&gt;: &lt;code&gt;{&amp;quot;Id&amp;quot;:1, &amp;quot;Username&amp;quot;:&amp;quot;admin&amp;quot;, ...}&lt;/code&gt;（整行数据 JSON）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;作用&lt;/strong&gt;: 真正存储数据的地方。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;strong&gt;Index Cache (唯一索引缓存)&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Key&lt;/strong&gt;: &lt;code&gt;cache:user:username:admin&lt;/code&gt; / &lt;code&gt;cache:user:phone:138xxxx&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Value&lt;/strong&gt;: &lt;code&gt;1&lt;/code&gt;（对应的 UserID）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;作用&lt;/strong&gt;: 只是一个路标，指向主键。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;2-查询流程从两步走到一步到位&#34;&gt;2. 查询流程：从“两步走”到“一步到位”
&lt;/h2&gt;&lt;h3 id=&#34;场景-a基于主键查询findoneid&#34;&gt;场景 A：基于主键查询（&lt;code&gt;FindOne(id)&lt;/code&gt;）
&lt;/h3&gt;&lt;p&gt;这是最快路径，一步到位。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;代码调用 &lt;code&gt;FindOne(1)&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;框架直接查 Redis &lt;code&gt;cache:user:id:1&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hit&lt;/strong&gt;: 拿到 JSON，反序列化返回。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Miss&lt;/strong&gt;: 查 MySQL -&amp;gt; 拿到整行数据 -&amp;gt; &lt;strong&gt;写入 Redis&lt;/strong&gt; -&amp;gt; 返回。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;场景-b基于唯一索引查询findonebyusernameadmin&#34;&gt;场景 B：基于唯一索引查询（&lt;code&gt;FindOneByUsername(&amp;quot;admin&amp;quot;)&lt;/code&gt;）
&lt;/h3&gt;&lt;p&gt;这是典型的“以空间换时间 + 数据归一化”策略。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;第一步（找 ID）&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;查 Redis &lt;code&gt;cache:user:username:admin&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;拿到 UserID: &lt;code&gt;1&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;strong&gt;第二步（找数据）&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;框架内部自动复用 &lt;code&gt;FindOne(1)&lt;/code&gt; 的逻辑。&lt;/li&gt;
&lt;li&gt;查 Redis &lt;code&gt;cache:user:id:1&lt;/code&gt; 拿到详细数据。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;为什么这么设计？&lt;/strong&gt;&lt;br&gt;
如果在 &lt;code&gt;username&lt;/code&gt; 的缓存里也存一份完整的 User 数据，当用户修改昵称时，需要同时更新 &lt;code&gt;id:1&lt;/code&gt;、&lt;code&gt;username:admin&lt;/code&gt;、&lt;code&gt;phone:xxxx&lt;/code&gt; 等多份缓存，极易产生不一致。&lt;br&gt;
现在的方案是只维护主键缓存：删除 &lt;code&gt;id:1&lt;/code&gt; 后，所有索引查询都会回到主键缓存，天然一致。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id=&#34;3-写入与更新流程cache-aside-pattern&#34;&gt;3. 写入与更新流程：Cache-Aside Pattern
&lt;/h2&gt;&lt;p&gt;go-zero 严格遵循 &lt;strong&gt;旁路缓存 (Cache-Aside)&lt;/strong&gt; 模式。&lt;/p&gt;
&lt;h3 id=&#34;31-什么时候写入缓存&#34;&gt;3.1 什么时候写入缓存？
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;只有在读取失败（Cache Miss）时才写入&lt;/strong&gt;。即 &lt;code&gt;Lazy Load&lt;/code&gt;（懒加载）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;并不是 update 完数据库马上写 Redis。&lt;/li&gt;
&lt;li&gt;而是 update 完只删缓存。下次谁来读，谁负责去把数据从 MySQL“搬运”到 Redis。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;32-更新删除时的自动清理&#34;&gt;3.2 更新/删除时的“自动清理”
&lt;/h3&gt;&lt;p&gt;当你调用 &lt;code&gt;Update(user)&lt;/code&gt; 或 &lt;code&gt;Delete(id)&lt;/code&gt; 时，框架底层（&lt;code&gt;sqlc.CachedConn&lt;/code&gt;）会自动执行以下操作：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;12
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;13
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;14
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;15
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;16
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;17
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;18
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#6272a4&#34;&gt;// 伪代码逻辑&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#50fa7b&#34;&gt;Delete&lt;/span&gt;(id &lt;span style=&#34;color:#8be9fd&#34;&gt;int64&lt;/span&gt;) &lt;span style=&#34;color:#8be9fd&#34;&gt;error&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6272a4&#34;&gt;// 1. 先查出老数据（为了拿到 username、phone 等索引键）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    data, _ &lt;span style=&#34;color:#ff79c6&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#50fa7b&#34;&gt;FindOne&lt;/span&gt;(id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6272a4&#34;&gt;// 2. 准备所有相关的 Redis Keys&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    keys &lt;span style=&#34;color:#ff79c6&#34;&gt;:=&lt;/span&gt; []&lt;span style=&#34;color:#8be9fd&#34;&gt;string&lt;/span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;cache:user:id:1&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;cache:user:username:admin&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#f1fa8c&#34;&gt;&amp;#34;cache:user:phone:138xxxx&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#6272a4&#34;&gt;// 3. 执行数据库操作 + 删除缓存&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    _, err &lt;span style=&#34;color:#ff79c6&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#50fa7b&#34;&gt;Exec&lt;/span&gt;(&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;func&lt;/span&gt;() &lt;span style=&#34;color:#8be9fd&#34;&gt;error&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff79c6&#34;&gt;return&lt;/span&gt; DB.&lt;span style=&#34;color:#50fa7b&#34;&gt;Delete&lt;/span&gt;(id)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }, keys&lt;span style=&#34;color:#ff79c6&#34;&gt;...&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff79c6&#34;&gt;return&lt;/span&gt; err
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;下面是 &lt;code&gt;github.com/zeromicro/go-zero@v1.9.4/core/stores/sqlc/cachedsql.go&lt;/code&gt; 中的具体代码，&lt;code&gt;ExecCtx&lt;/code&gt; 是生成的 model 层代码里执行数据库操作并删除缓存的方法：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;func&lt;/span&gt; (cc CachedConn) &lt;span style=&#34;color:#50fa7b&#34;&gt;ExecCtx&lt;/span&gt;(ctx context.Context, exec ExecCtxFn, keys &lt;span style=&#34;color:#ff79c6&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color:#8be9fd&#34;&gt;string&lt;/span&gt;) (
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sql.Result, &lt;span style=&#34;color:#8be9fd&#34;&gt;error&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    res, err &lt;span style=&#34;color:#ff79c6&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#50fa7b&#34;&gt;exec&lt;/span&gt;(ctx, cc.db)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff79c6&#34;&gt;if&lt;/span&gt; err &lt;span style=&#34;color:#ff79c6&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#ff79c6&#34;&gt;nil&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;        &lt;span style=&#34;color:#ff79c6&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ff79c6&#34;&gt;nil&lt;/span&gt;, err
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    }
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#ff79c6&#34;&gt;return&lt;/span&gt; res, cc.&lt;span style=&#34;color:#50fa7b&#34;&gt;DelCacheCtx&lt;/span&gt;(ctx, keys&lt;span style=&#34;color:#ff79c6&#34;&gt;...&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;如果 Redis 里有缓存&lt;/strong&gt; -&amp;gt; &lt;code&gt;DEL&lt;/code&gt; 命令被执行，缓存被清空。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;如果 Redis 里没缓存&lt;/strong&gt; -&amp;gt; &lt;code&gt;DEL&lt;/code&gt; 命令依然被执行（返回 0），没有任何副作用。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;4-总结&#34;&gt;4. 总结
&lt;/h2&gt;&lt;p&gt;go-zero 的缓存机制通过 &lt;strong&gt;Model 代码生成&lt;/strong&gt; 帮我们屏蔽了复杂的细节：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;数据归一&lt;/strong&gt;：所有数据实体只存一份（在 ID 缓存里）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;索引映射&lt;/strong&gt;：唯一索引只存 ID，通过两次查找解决问题。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;一致性保证&lt;/strong&gt;：修改数据库自动级联删除对应的所有缓存 Key（包括 ID Key 和 Index Keys）。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这套机制简单、健壮，是解决高并发读问题的最佳实践之一。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
